{% extends "base.html" %}

{% block content %}
<style>
    /* Druckoptimierung */
    @media print {
        .no-print {
            display: none;
        }
        body {
            margin: 1cm;
        }
        h1, h2, h3 {
            margin-bottom: 0.2cm;
        }
		.question {
			page-break-inside: avoid !important;
			break-inside: avoid !important;
			margin-bottom: 2rem; /* optional für mehr Abstand */
			padding-bottom: 1rem; /* optional für Optik */
		}
    }

    .meta {
        margin-bottom: 1rem;
    }

    .meta-table td {
        padding: 0.2rem 0.5rem;
    }

    .question {
        margin-bottom: 1.2rem;
    }

    .points {
        float: right;
        font-weight: bold;
    }

    .topic-label {
        font-size: 0.8rem;
        color: #555;
    }
</style>

<div class="no-print">
    <button onclick="window.print()">Drucken</button>
    &nbsp;
    <a href="{{ url_for('list_tests') }}">Zurück zur Testübersicht</a>
</div>

<h2>{{ test['name'] }}</h2>

<div class="meta">
    <table class="meta-table">
        <tr>
            <td><strong>Datum:</strong></td>
            <td>{{ test['date'] or "____.__.____" }}</td>
        </tr>
        <tr>
            <td><strong>Name:</strong></td>
            <td>__________________________________________</td>
        </tr>
        <tr>
            <td><strong>Klasse:</strong></td>
            <td>__________________</td>
        </tr>
        {% if test['notes'] %}
        <tr>
            <td><strong>Hinweise:</strong></td>
            <td>{{ test['notes'] }}</td>
        </tr>
        {% endif %}
    </table>
</div>

<hr>

{% if questions %}
    {% for q in questions %}
        <div class="question">
            <div class="points">
                [{{ q['points']|default(1) }} P]
            </div>
            <div>
                <strong>{{ loop.index }}.)</strong>
                {{ q['text'] }}
            </div>
            <div class="topic-label">
                Thema: {{ q['topic_name'] }}
            </div>

            <!-- Platz für Schüler-Antworten -->
	    	<div class="answer-block">
            </div>
        </div>
    {% endfor %}
{% else %}
    <p>Diesem Test sind noch keine Fragen zugeordnet.</p>
{% endif %}

<hr style="margin-top: 40px;">

<!-- Notenschlüssel -->
<div class="grading-info" style="margin-bottom: 12px; font-size: 12px; color: #444;">
    <strong>Notenschlüssel:</strong>
    [Sehr gut (1) ≥ 91 %] –
    [Gut (2) ≥ 81 %] –
    [Befriedigend (3) ≥ 61 %] –
    [Genügend (4) ≥ 51 %] –
    [Nicht genügend (5) ≥ 0 %]
</div>

<!-- Bewertungstabelle -->
<table class="grading-table" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
    <tr>
        <td style="border: 1px solid #aaa; padding: 8px; width: 40%;">
            Punkteanzahl:
        </td>
        <td style="border: 1px solid #aaa; padding: 8px; width: 60%;">
            Beurteilung:
        </td>
    </tr>
</table>

{% endblock %}
